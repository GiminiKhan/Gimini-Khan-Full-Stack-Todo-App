(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3226:function(e,t,r){Promise.resolve().then(r.bind(r,9080)),Promise.resolve().then(r.t.bind(r,1371,23)),Promise.resolve().then(r.t.bind(r,2853,23))},9080:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var o=r(7437),n=r(2265),s=r(6885);let i=(0,n.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[r,a]=(0,n.useState)(null),[l,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let initAuth=async()=>{try{let e=await (0,s.t0)();e&&a(e)}catch(e){console.error("Auth initialization error:",e),(0,s.TX)()}finally{u(!1)}};initAuth()},[]);let checkAuth=async()=>{try{let e=await (0,s.t0)();if(e){a(e);return}a(null)}catch(e){console.error("Auth check error:",e),a(null)}};return(0,o.jsx)(i.Provider,{value:{user:r,loading:l,login:(e,t)=>{localStorage.setItem("accessToken",t),a(e)},logout:()=>{(0,s.TX)(),a(null)},checkAuth},children:t})}function useAuth(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6885:function(e,t,r){"use strict";r.d(t,{t0:function(){return checkAuthStatus},hP:function(){return getAccessToken},pH:function(){return loginUser},TX:function(){return logoutUser},a$:function(){return registerUser},j1:function(){return saveAccessToken}});var o=r(6989),n=r(2601);let s=(0,o.X)({baseURL:n.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:8000",fetchOptions:{credentials:"include"}}),{signIn:i,signOut:a,useSession:l}=s,registerUser=async e=>{console.log("Attempting registration with data:",e);try{var t,r,o,n,s,a;let l=await i.email({email:e.email,password:e.password,callbackURL:"/dashboard"});return console.log("Registration response received:",l),{id:(null===(r=l.data)||void 0===r?void 0:null===(t=r.user)||void 0===t?void 0:t.id)||"",email:(null===(n=l.data)||void 0===n?void 0:null===(o=n.user)||void 0===o?void 0:o.email)||"",full_name:null===(a=l.data)||void 0===a?void 0:null===(s=a.user)||void 0===s?void 0:s.name,is_active:!0}}catch(e){throw console.error("Better Auth registration error:",e),e}},loginUser=async e=>{console.log("Attempting login with credentials:",e);try{var t;let r=await i.email({email:e.email,password:e.password,callbackURL:"/dashboard"});return console.log("Login response received:",r),{access_token:(null===(t=r.data)||void 0===t?void 0:t.token)||"better_auth_session",token_type:"bearer"}}catch(e){throw console.error("Better Auth login error:",e),e}},checkAuthStatus=async()=>{console.log("Checking auth status...");try{let e=await fetch("/api/auth/session");if(console.log("Auth status response:",e.status),e.ok){let t=await e.json();if(console.log("Session data:",t),t.user)return{id:t.user.id,email:t.user.email,full_name:t.user.name||t.user.email.split("@")[0],is_active:!0}}return null}catch(e){return console.error("Better Auth status check error:",e),null}},logoutUser=async()=>{try{await a()}catch(e){throw console.error("Better Auth logout error:",e),e}},saveAccessToken=e=>{localStorage.setItem("better-auth.session_token",e)},getAccessToken=()=>localStorage.getItem("better-auth.session_token")},2853:function(){},1371:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[996,971,472,744],function(){return e(e.s=3226)}),_N_E=e.O()}]);