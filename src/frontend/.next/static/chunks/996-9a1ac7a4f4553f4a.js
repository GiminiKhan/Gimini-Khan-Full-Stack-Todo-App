(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{2601:function(e,t,n){"use strict";var r,o;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(8960)},8960:function(e){!function(){var t={229:function(e){var t,n,r,o=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function runClearTimeout(e){if(n===clearTimeout)return clearTimeout(e);if((n===defaultClearTimeout||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{n="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){n=defaultClearTimeout}}();var s=[],i=!1,a=-1;function cleanUpNextTick(){i&&r&&(i=!1,r.length?s=r.concat(s):a=-1,s.length&&drainQueue())}function drainQueue(){if(!i){var e=runTimeout(cleanUpNextTick);i=!0;for(var t=s.length;t;){for(r=s,s=[];++a<t;)r&&r[a].run();a=-1,t=s.length}r=null,i=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new Item(e,t)),1!==s.length||i||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=noop,o.addListener=noop,o.once=noop,o.off=noop,o.removeListener=noop,o.removeAllListeners=noop,o.emit=noop,o.prependListener=noop,o.prependOnceListener=noop,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function __nccwpck_require__(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}},s=!0;try{t[e](o,o.exports,__nccwpck_require__),s=!1}finally{s&&delete n[e]}return o.exports}__nccwpck_require__.ab="//";var r=__nccwpck_require__(229);e.exports=r}()},622:function(e,t,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2265),o=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,n){var r,s={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:o,type:e,key:u,ref:c,props:s,_owner:a.current}}t.Fragment=s,t.jsx=q,t.jsxs=q},7437:function(e,t,n){"use strict";e.exports=n(622)},6989:function(e,t,n){"use strict";n.d(t,{X:function(){return createAuthClient}});var r=n(2601);let o=Object.create(null),_getEnv=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?o:globalThis),s=new Proxy(o,{get:(e,t)=>_getEnv()[t]??o[t],has:(e,t)=>t in _getEnv()||t in o,set(e,t,n){let r=_getEnv(!0);return r[t]=n,!0},deleteProperty(e,t){if(!t)return!1;let n=_getEnv(!0);return delete n[t],!0},ownKeys(){let e=_getEnv(!0);return Object.keys(e)}});function getEnvVar(e,t){return void 0!==r&&r.env?r.env[e]??t:"undefined"!=typeof Deno?Deno.env.get(e)??t:"undefined"!=typeof Bun?Bun.env[e]??t:t}void 0!==r&&r.env,Object.freeze({get BETTER_AUTH_SECRET(){return getEnvVar("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return getEnvVar("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return getEnvVar("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return getEnvVar("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return getEnvVar("NODE_ENV","development")},get PACKAGE_VERSION(){return getEnvVar("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return getEnvVar("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}});let i={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},a=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),l=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/];function getColorDepth(){if(void 0!==getEnvVar("FORCE_COLOR"))switch(getEnvVar("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==getEnvVar("NODE_DISABLE_COLORS")&&""!==getEnvVar("NODE_DISABLE_COLORS")||void 0!==getEnvVar("NO_COLOR")&&""!==getEnvVar("NO_COLOR")||"dumb"===getEnvVar("TERM"))return 1;if(getEnvVar("TMUX"))return 24;if("TF_BUILD"in s&&"AGENT_NAME"in s)return 4;if("CI"in s){for(let{0:e,1:t}of a)if(e in s)return t;return"codeship"===getEnvVar("CI_NAME")?8:1}if("TEAMCITY_VERSION"in s)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(getEnvVar("TEAMCITY_VERSION"))?4:1;switch(getEnvVar("TERM_PROGRAM")){case"iTerm.app":if(!getEnvVar("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(getEnvVar("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===getEnvVar("COLORTERM")||"24bit"===getEnvVar("COLORTERM"))return 24;if(getEnvVar("TERM")){if(null!==/truecolor/.exec(getEnvVar("TERM")))return 24;if(null!==/^xterm-256/.exec(getEnvVar("TERM")))return 8;let e=getEnvVar("TERM").toLowerCase();if(i[e])return i[e];if(l.some(t=>null!==t.exec(e)))return 4}return getEnvVar("COLORTERM")?4:1}let u={reset:"\x1b[0m",bright:"\x1b[1m",dim:"\x1b[2m",fg:{black:"\x1b[30m",red:"\x1b[31m",green:"\x1b[32m",yellow:"\x1b[33m",blue:"\x1b[34m",magenta:"\x1b[35m",cyan:"\x1b[36m",white:"\x1b[37m"}},c=["debug","info","success","warn","error"];function shouldPublishLog(e,t){return c.indexOf(t)>=c.indexOf(e)}let f={info:u.fg.blue,success:u.fg.green,warn:u.fg.yellow,error:u.fg.red,debug:u.fg.magenta},formatMessage=(e,t,n)=>{let r=new Date().toISOString();return n?`${u.dim}${r}${u.reset} ${f[e]}${e.toUpperCase()}${u.reset} ${u.bright}[Better Auth]:${u.reset} ${t}`:`${r} ${e.toUpperCase()} [Better Auth]: ${t}`};function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}(e=>{let t=e?.disabled!==!0,n=e?.level??"error",r=e?.disableColors!==void 0?!e.disableColors:1!==getColorDepth(),LogFunc=(o,s,i=[])=>{if(!t||!shouldPublishLog(n,o))return;let a=formatMessage(o,s,r);if(!e||"function"!=typeof e.log){"error"===o?console.error(a,...i):"warn"===o?console.warn(a,...i):console.log(a,...i);return}e.log("success"===o?"info":o,s,...i)};return{...Object.fromEntries(c.map(e=>[e,(...[t,...n])=>LogFunc(e,t,n)])),get level(){return n}}})();var d=class extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}};function checkHasPath(e){try{return"/"!==(new URL(e).pathname.replace(/\/+$/,"")||"/")}catch{throw new d(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}function assertHasProtocol(e){try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new d(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){if(t instanceof d)throw t;throw new d(`Invalid base URL: ${e}. Please provide a valid base URL.`,String(t))}}function withPath(e,t="/api/auth"){if(assertHasProtocol(e),checkHasPath(e))return e;let n=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${n}${t}`):n}function validateProxyHeader(e,t){return!!e&&""!==e.trim()&&("proto"===t?"http"===e||"https"===e:"host"===t&&![/\.\./,/\0/,/[\s]/,/^[.]/,/[<>'"]/,/javascript:/i,/file:/i,/data:/i].some(t=>t.test(e))&&(/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?$/.test(e)||/^(\d{1,3}\.){3}\d{1,3}(:[0-9]{1,5})?$/.test(e)||/^\[[0-9a-fA-F:]+\](:[0-9]{1,5})?$/.test(e)||/^localhost(:[0-9]{1,5})?$/i.test(e)))}function getBaseURL(e,t,n,r,o){if(e)return withPath(e,t);if(!1!==r){let e=s.BETTER_AUTH_URL||s.NEXT_PUBLIC_BETTER_AUTH_URL||s.PUBLIC_BETTER_AUTH_URL||s.NUXT_PUBLIC_BETTER_AUTH_URL||s.NUXT_PUBLIC_AUTH_URL||("/"!==s.BASE_URL?s.BASE_URL:void 0);if(e)return withPath(e,t)}let i=n?.headers.get("x-forwarded-host"),a=n?.headers.get("x-forwarded-proto");if(i&&a&&o&&validateProxyHeader(a,"proto")&&validateProxyHeader(i,"host"))try{return withPath(`${a}://${i}`,t)}catch(e){}if(n){let e=getOrigin(n.url);if(!e)throw new d("Could not get origin from request. Please provide a valid base URL.");return withPath(e,t)}if("undefined"!=typeof window&&window.location)return withPath(window.location.origin,t)}function getOrigin(e){try{let t=new URL(e);return"null"===t.origin?null:t.origin}catch{return null}}let p={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"undefined"!=typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},h={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},g=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,v={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},y=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/;function isValidDate(e){return e instanceof Date&&!isNaN(e.getTime())}function parseISODate(e){let t=y.exec(e);if(!t)return null;let[,n,r,o,s,i,a,l,u,c,f]=t,d=new Date(Date.UTC(parseInt(n,10),parseInt(r,10)-1,parseInt(o,10),parseInt(s,10),parseInt(i,10),parseInt(a,10),l?parseInt(l.padEnd(3,"0"),10):0));if(u){let e=(60*parseInt(c,10)+parseInt(f,10))*("+"===u?-1:1);d.setUTCMinutes(d.getUTCMinutes()+e)}return isValidDate(d)?d:null}function betterJSONParse(e,t={}){let{strict:n=!1,warnings:r=!1,reviver:o,parseDates:s=!0}=t;if("string"!=typeof e)return e;let i=e.trim();if(i.length>0&&'"'===i[0]&&i.endsWith('"')&&!i.slice(1,-1).includes('"'))return i.slice(1,-1);let a=i.toLowerCase();if(a.length<=9&&a in v)return v[a];if(!g.test(i)){if(n)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(h).some(([e,t])=>{let n=t.test(i);return n&&r&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),n})&&n)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(i,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){r&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(s&&"string"==typeof t){let e=parseISODate(t);if(e)return e}return o?o(e,t):t})}catch(t){if(n)throw t;return e}}function parseJSON(e,t={strict:!0}){return betterJSONParse(e,t)}let m=[],b=0,_=0,atom=e=>{let t=[],n={get:()=>(n.lc||n.listen(()=>{})(),n.value),lc:0,listen:e=>(n.lc=t.push(e),()=>{for(let t=b+4;t<m.length;)m[t]===e?m.splice(t,4):t+=4;let r=t.indexOf(e);!~r||(t.splice(r,1),--n.lc||n.off())}),notify(e,r){_++;let o=!m.length;for(let o of t)m.push(o,n.value,e,r);if(o){for(b=0;b<m.length;b+=4)m[b](m[b+1],m[b+2],m[b+3]);m.length=0}},off(){},set(e){let t=n.value;t!==e&&(n.value=e,n.notify(t))},subscribe(e){let t=n.listen(e);return e(n.value),t},value:e};return n},on=(e,t,n,r)=>(e.events=e.events||{},e.events[n+10]||(e.events[n+10]=r(t=>{e.events[n].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[n]=e.events[n]||[],e.events[n].push(t),()=>{let r=e.events[n],o=r.indexOf(t);r.splice(o,1),r.length||(delete e.events[n],e.events[n+10](),delete e.events[n+10])}),onMount=(e,t)=>on(e,n=>{let r=t(n);r&&e.events[6].push(r)},5,t=>{let n=e.listen;e.listen=(...r)=>(e.lc||e.active||(e.active=!0,t()),n(...r));let r=e.off;return e.events[6]=[],e.off=()=>{r(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=n,e.off=r}}),isServer=()=>"undefined"==typeof window,useAuthQuery=(e,t,n,r)=>{let o=atom({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>fn(e)}),fn=async e=>new Promise(s=>{let i="function"==typeof r?r({data:o.get().data,error:o.get().error,isPending:o.get().isPending}):r;n(t,{...i,query:{...i?.query,...e?.query},async onSuccess(e){o.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await i?.onSuccess?.(e)},async onError(e){let{request:t}=e,n="number"==typeof t.retry?t.retry:t.retry?.attempts,r=t.retryAttempt||0;n&&r<n||(o.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await i?.onError?.(e))},async onRequest(e){let t=o.get();o.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:o.value.refetch}),await i?.onRequest?.(e)}}).catch(e=>{o.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch})}).finally(()=>{s(void 0)})});e=Array.isArray(e)?e:[e];let s=!1;for(let t of e)t.subscribe(async()=>{isServer()||(s?await fn():onMount(o,()=>{let e=setTimeout(async()=>{s||(await fn(),s=!0)},0);return()=>{o.off(),t.off(),clearTimeout(e)}}))});return o},w=Symbol.for("better-auth:broadcast-channel"),now=()=>Math.floor(Date.now()/1e3);var E=class{listeners=new Set;name;constructor(e="better-auth.message"){this.name=e}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}post(e){if("undefined"!=typeof window)try{localStorage.setItem(this.name,JSON.stringify({...e,timestamp:now()}))}catch{}}setup(){if("undefined"==typeof window||void 0===window.addEventListener)return()=>{};let handler=e=>{if(e.key!==this.name)return;let t=JSON.parse(e.newValue??"{}");t?.event==="session"&&t?.data&&this.listeners.forEach(e=>e(t))};return window.addEventListener("storage",handler),()=>{window.removeEventListener("storage",handler)}}};function getGlobalBroadcastChannel(e="better-auth.message"){return globalThis[w]||(globalThis[w]=new E(e)),globalThis[w]}let T=Symbol.for("better-auth:focus-manager");var R=class{listeners=new Set;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setFocused(e){this.listeners.forEach(t=>t(e))}setup(){if("undefined"==typeof window||"undefined"==typeof document||void 0===window.addEventListener)return()=>{};let visibilityHandler=()=>{"visible"===document.visibilityState&&this.setFocused(!0)};return document.addEventListener("visibilitychange",visibilityHandler,!1),()=>{document.removeEventListener("visibilitychange",visibilityHandler,!1)}}};function getGlobalFocusManager(){return globalThis[T]||(globalThis[T]=new R),globalThis[T]}let O=Symbol.for("better-auth:online-manager");var S=class{listeners=new Set;isOnline="undefined"==typeof navigator||navigator.onLine;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}setup(){if("undefined"==typeof window||void 0===window.addEventListener)return()=>{};let onOnline=()=>this.setOnline(!0),onOffline=()=>this.setOnline(!1);return window.addEventListener("online",onOnline,!1),window.addEventListener("offline",onOffline,!1),()=>{window.removeEventListener("online",onOnline,!1),window.removeEventListener("offline",onOffline,!1)}}};function getGlobalOnlineManager(){return globalThis[O]||(globalThis[O]=new S),globalThis[O]}let session_refresh_now=()=>Math.floor(Date.now()/1e3);function createSessionRefreshManager(e){let{sessionAtom:t,sessionSignal:n,$fetch:r,options:o={}}=e,s=o.sessionOptions?.refetchInterval??0,i=o.sessionOptions?.refetchOnWindowFocus??!0,a=o.sessionOptions?.refetchWhenOffline??!1,l={lastSync:0,lastSessionRequest:0,cachedSession:void 0},shouldRefetch=()=>a||getGlobalOnlineManager().isOnline,triggerRefetch=e=>{if(!shouldRefetch())return;if(e?.event==="storage"){l.lastSync=session_refresh_now(),n.set(!n.get());return}let o=t.get();if(e?.event==="poll"){l.lastSessionRequest=session_refresh_now(),r("/get-session").then(e=>{e.error?t.set({...o,data:null,error:e.error}):t.set({...o,data:e.data,error:null}),l.lastSync=session_refresh_now(),n.set(!n.get())}).catch(()=>{});return}if(e?.event==="visibilitychange"){if(session_refresh_now()-l.lastSessionRequest<5)return;l.lastSessionRequest=session_refresh_now()}(o?.data===null||o?.data===void 0||e?.event==="visibilitychange")&&(l.lastSync=session_refresh_now(),n.set(!n.get()))},setupPolling=()=>{s&&s>0&&(l.pollInterval=setInterval(()=>{t.get()?.data&&triggerRefetch({event:"poll"})},1e3*s))},setupBroadcast=()=>{l.unsubscribeBroadcast=getGlobalBroadcastChannel().subscribe(()=>{triggerRefetch({event:"storage"})})},setupFocusRefetch=()=>{i&&(l.unsubscribeFocus=getGlobalFocusManager().subscribe(()=>{triggerRefetch({event:"visibilitychange"})}))},setupOnlineRefetch=()=>{l.unsubscribeOnline=getGlobalOnlineManager().subscribe(e=>{e&&triggerRefetch({event:"visibilitychange"})})};return{init:()=>{setupPolling(),setupBroadcast(),setupFocusRefetch(),setupOnlineRefetch(),getGlobalBroadcastChannel().setup(),getGlobalFocusManager().setup(),getGlobalOnlineManager().setup()},cleanup:()=>{l.pollInterval&&(clearInterval(l.pollInterval),l.pollInterval=void 0),l.unsubscribeBroadcast&&(l.unsubscribeBroadcast(),l.unsubscribeBroadcast=void 0),l.unsubscribeFocus&&(l.unsubscribeFocus(),l.unsubscribeFocus=void 0),l.unsubscribeOnline&&(l.unsubscribeOnline(),l.unsubscribeOnline=void 0),l.lastSync=0,l.lastSessionRequest=0,l.cachedSession=void 0},triggerRefetch,broadcastSessionUpdate:e=>{getGlobalBroadcastChannel().post({event:"session",data:{trigger:e},clientId:Math.random().toString(36).substring(7)})}}}function getSessionAtom(e,t){let n=atom(!1),r=useAuthQuery(n,"/get-session",e,{method:"GET"});return onMount(r,()=>{let o=createSessionRefreshManager({sessionAtom:r,sessionSignal:n,$fetch:e,options:t});return o.init(),()=>{o.cleanup()}}),{session:r,$sessionSignal:n}}var P=Object.defineProperty,A=Object.defineProperties,L=Object.getOwnPropertyDescriptors,x=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))I.call(t,n)&&__defNormalProp(e,n,t[n]);if(x)for(var n of x(t))C.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__spreadProps=(e,t)=>A(e,L(t)),U=class extends Error{constructor(e,t,n){super(t||e.toString(),{cause:n}),this.status=e,this.statusText=t,this.error=n,Error.captureStackTrace(this,this.constructor)}},initializePlugins=async(e,t)=>{var n,r,o,s,i,a;let l=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let r=await (null==(n=c.init)?void 0:n.call(c,e.toString(),t));l=r.options||l,e=r.url}u.onRequest.push(null==(r=c.hooks)?void 0:r.onRequest),u.onResponse.push(null==(o=c.hooks)?void 0:o.onResponse),u.onSuccess.push(null==(s=c.hooks)?void 0:s.onSuccess),u.onError.push(null==(i=c.hooks)?void 0:i.onError),u.onRetry.push(null==(a=c.hooks)?void 0:a.onRetry)}return{url:e,options:l,hooks:u}},N=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},V=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){let t=Math.min(this.options.maxDelay,this.options.baseDelay*2**e);return t}};function createRetryStrategy(e){if("number"==typeof e)return new N({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new N(e);case"exponential":return new V(e);default:throw Error("Invalid retry strategy")}}var getAuthHeader=async e=>{let t={},getValue=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await getValue(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let[n,r]=await Promise.all([getValue(e.auth.username),getValue(e.auth.password)]);if(!n||!r)return t;t.authorization=`Basic ${btoa(`${n}:${r}`)}`}else if("Custom"===e.auth.type){let[n,r]=await Promise.all([getValue(e.auth.prefix),getValue(e.auth.value)]);if(!r)return t;t.authorization=`${null!=n?n:""} ${r}`}}return t},j=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function detectResponseType(e){let t=e.headers.get("content-type"),n=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let r=t.split(";").shift()||"";return j.test(r)?"json":n.has(r)||r.startsWith("text/")?"text":"blob"}function isJSONParsable(e){try{return JSON.parse(e),!0}catch(e){return!1}}function isJSONSerializable(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function jsonParse(e){try{return JSON.parse(e)}catch(t){return e}}function isFunction(e){return"function"==typeof e}function getFetch(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&isFunction(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&isFunction(window.fetch))return window.fetch;throw Error("No fetch implementation found")}async function getHeaders(e){let t=new Headers(null==e?void 0:e.headers),n=await getAuthHeader(e);for(let[e,r]of Object.entries(n||{}))t.set(e,r);if(!t.has("content-type")){let n=detectContentType(null==e?void 0:e.body);n&&t.set("content-type",n)}return t}function detectContentType(e){return isJSONSerializable(e)?"application/json":null}function getBody(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(isJSONSerializable(e.body)&&!t.has("content-type")){for(let[t,n]of Object.entries(null==e?void 0:e.body))n instanceof Date&&(e.body[t]=n.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&"application/x-www-form-urlencoded"===t.get("content-type")&&isJSONSerializable(e.body)?new URLSearchParams(e.body).toString():e.body}function getMethod(e,t){var n;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let r=null==(n=e.split("@")[1])?void 0:n.split("/")[0];return $.includes(r)?r.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}function getTimeout(e,t){let n;return!(null==e?void 0:e.signal)&&(null==e?void 0:e.timeout)&&(n=setTimeout(()=>null==t?void 0:t.abort(),null==e?void 0:e.timeout)),{abortTimeout:n,clearTimeout:()=>{n&&clearTimeout(n)}}}var M=class _ValidationError extends Error{constructor(e,t){super(t||JSON.stringify(e,null,2)),this.issues=e,Object.setPrototypeOf(this,_ValidationError.prototype)}};async function parseStandardSchema(e,t){let n=await e["~standard"].validate(t);if(n.issues)throw new M(n.issues);return n.value}var $=["get","post","put","patch","delete"],applySchemaPlugin=e=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(t,n){var r,o,s,i;let a=(null==(o=null==(r=e.plugins)?void 0:r.find(e=>{var n;return null!=(n=e.schema)&&!!n.config&&(t.startsWith(e.schema.config.baseURL||"")||t.startsWith(e.schema.config.prefix||""))}))?void 0:o.schema)||e.schema;if(a){let e=t;(null==(s=a.config)?void 0:s.prefix)&&e.startsWith(a.config.prefix)&&(e=e.replace(a.config.prefix,""),a.config.baseURL&&(t=t.replace(a.config.prefix,a.config.baseURL))),(null==(i=a.config)?void 0:i.baseURL)&&e.startsWith(a.config.baseURL)&&(e=e.replace(a.config.baseURL,""));let r=a.schema[e];if(r){let e=__spreadProps(__spreadValues({},n),{method:r.method,output:r.output});return(null==n?void 0:n.disableValidation)||(e=__spreadProps(__spreadValues({},e),{body:r.input?await parseStandardSchema(r.input,null==n?void 0:n.body):null==n?void 0:n.body,params:r.params?await parseStandardSchema(r.params,null==n?void 0:n.params):null==n?void 0:n.params,query:r.query?await parseStandardSchema(r.query,null==n?void 0:n.query):null==n?void 0:n.query})),{url:t,options:e}}}return{url:t,options:n}}}),createFetch=e=>async function(t,n){let r=__spreadProps(__spreadValues(__spreadValues({},e),n),{plugins:[...(null==e?void 0:e.plugins)||[],applySchemaPlugin(e||{}),...(null==n?void 0:n.plugins)||[]]});return null==e||e.catchAllError,await betterFetch(t,r)};function getURL2(e,t){let{baseURL:n,params:r,query:o}=t||{query:{},params:{},baseURL:""},s=e.startsWith("http")?e.split("/").slice(0,3).join("/"):n||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];$.includes(t)&&(e=e.replace(`@${t}/`,"/"))}s.endsWith("/")||(s+="/");let[i,a]=e.replace(s,"").split("?"),l=new URLSearchParams(a);for(let[e,t]of Object.entries(o||{})){let n;if(null!=t){if("string"==typeof t)n=t;else if(Array.isArray(t)){for(let n of t)l.append(e,n);continue}else n=JSON.stringify(t);l.set(e,n)}}if(r){if(Array.isArray(r)){let e=i.split("/").filter(e=>e.startsWith(":"));for(let[t,n]of e.entries()){let e=r[t];i=i.replace(n,e)}}else for(let[e,t]of Object.entries(r))i=i.replace(`:${e}`,String(t))}(i=i.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(i=i.slice(1));let u=l.toString();if(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",!s.startsWith("http"))return`${s}${i}${u}`;let c=new URL(`${i}${u}`,s);return c}var betterFetch=async(e,t)=>{var n,r,o,s,i,a,l,u;let{hooks:c,url:f,options:d}=await initializePlugins(e,t),p=getFetch(d),h=new AbortController,g=null!=(n=d.signal)?n:h.signal,v=getURL2(f,d),y=getBody(d),m=await getHeaders(d),b=getMethod(f,d),_=__spreadProps(__spreadValues({},d),{url:v,headers:m,body:y,method:b,signal:g});for(let e of c.onRequest)if(e){let t=await e(_);"object"==typeof t&&null!==t&&(_=t)}("pipeTo"in _&&"function"==typeof _.pipeTo||"function"==typeof(null==(r=null==t?void 0:t.body)?void 0:r.pipe))&&!("duplex"in _)&&(_.duplex="half");let{clearTimeout:w}=getTimeout(d,h),E=await p(_.url,_);w();let T={response:E,request:_};for(let e of c.onResponse)if(e){let n=await e(__spreadProps(__spreadValues({},T),{response:(null==(o=null==t?void 0:t.hookOptions)?void 0:o.cloneResponse)?E.clone():E}));n instanceof Response?E=n:"object"==typeof n&&null!==n&&(E=n.response)}if(E.ok){let e="HEAD"!==_.method;if(!e)return{data:"",error:null};let n=detectResponseType(E),r={data:null,response:E,request:_};if("json"===n||"text"===n){let e=await E.text(),t=null!=(s=_.jsonParser)?s:jsonParse;r.data=await t(e)}else r.data=await E[n]();for(let e of((null==_?void 0:_.output)&&_.output&&!_.disableValidation&&(r.data=await parseStandardSchema(_.output,r.data)),c.onSuccess))e&&await e(__spreadProps(__spreadValues({},r),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?E.clone():E}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let R=null!=(a=null==t?void 0:t.jsonParser)?a:jsonParse,O=await E.text(),S=isJSONParsable(O),P=S?await R(O):null,A={response:E,responseText:O,request:_,error:__spreadProps(__spreadValues({},P),{status:E.status,statusText:E.statusText})};for(let e of c.onError)e&&await e(__spreadProps(__spreadValues({},A),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?E.clone():E}));if(null==t?void 0:t.retry){let n=createRetryStrategy(t.retry),r=null!=(u=t.retryAttempt)?u:0;if(await n.shouldAttemptRetry(r,E)){for(let e of c.onRetry)e&&await e(T);let o=n.getDelay(r);return await new Promise(e=>setTimeout(e,o)),await betterFetch(e,__spreadProps(__spreadValues({},t),{retryAttempt:r+1}))}}if(null==t?void 0:t.throw)throw new U(E.status,E.statusText,S?P:O);return{data:null,error:__spreadProps(__spreadValues({},P),{status:E.status,statusText:E.statusText})}};let getClientConfig=(e,t)=>{let n="credentials"in Request.prototype,r=getBaseURL(e?.baseURL,e?.basePath,void 0,t)??"/api/auth",o=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],s={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:i,onError:a,onRequest:l,onResponse:u,...c}=e?.fetchOptions||{},f=createFetch({baseURL:r,...n?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?parseJSON(e,{strict:!1}):null,customFetchImpl:fetch,...c,plugins:[s,...c.plugins||[],...e?.disableDefaultFetchPlugins?[]:[p],...o]}),{$sessionSignal:d,session:h}=getSessionAtom(f,e),g=e?.plugins||[],v={},y={$sessionSignal:d,session:h},m={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},b=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||"/sign-up/email"===e||"/sign-in/email"===e||"/delete-user"===e||"/verify-email"===e||"/revoke-sessions"===e||"/revoke-session"===e||"/change-email"===e}];for(let e of g)e.getAtoms&&Object.assign(y,e.getAtoms?.(f)),e.pathMethods&&Object.assign(m,e.pathMethods),e.atomListeners&&b.push(...e.atomListeners);let _={notify:e=>{y[e].set(!y[e].get())},listen:(e,t)=>{y[e].subscribe(t)},atoms:y};for(let t of g)t.getActions&&Object.assign(v,t.getActions?.(f,_,e));return{get baseURL(){return r},pluginsActions:v,pluginsAtoms:y,pluginPathMethods:m,atomListeners:b,$fetch:f,$store:_}};function isAtom(e){return"object"==typeof e&&null!==e&&"get"in e&&"function"==typeof e.get&&"lc"in e&&"number"==typeof e.lc}function proxy_getMethod(e,t,n){let r=t[e],{fetchOptions:o,query:s,...i}=n||{};return r||(o?.method?o.method:i&&Object.keys(i).length>0?"POST":"GET")}function createDynamicPathProxy(e,t,n,r,o){function createProxy(s=[]){return new Proxy(function(){},{get(t,n){if("string"!=typeof n||"then"===n||"catch"===n||"finally"===n)return;let r=[...s,n],o=e;for(let e of r)if(o&&"object"==typeof o&&e in o)o=o[e];else{o=void 0;break}return"function"==typeof o||isAtom(o)?o:createProxy(r)},apply:async(e,i,a)=>{let l="/"+s.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),u=a[0]||{},c=a[1]||{},{query:f,fetchOptions:d,...p}=u,h={...c,...d},g=proxy_getMethod(l,n,u);return await t(l,{...h,body:"GET"===g?void 0:{...p,...h?.body||{}},query:f||h?.query,method:g,async onSuccess(e){if(await h?.onSuccess?.(e),!o||h.disableSignal)return;let t=o.filter(e=>e.matcher(l));if(!t.length)return;let n=new Set;for(let e of t){let t=r[e.signal];if(!t)return;if(n.has(e.signal))continue;n.add(e.signal);let o=t.get();setTimeout(()=>{t.set(!o)},10)}}})}})}return createProxy()}function listenKeys(e,t,n){let r=new Set(t).add(void 0);return e.listen((e,t,o)=>{r.has(o)&&n(e,t,o)})}var k=n(2265);function useStore(e,t={}){let n=(0,k.useRef)(e.get()),{keys:r,deps:o=[e,r]}=t,s=(0,k.useCallback)(t=>{let emitChange=e=>{n.current!==e&&(n.current=e,t())};return(emitChange(e.value),r?.length)?listenKeys(e,r,emitChange):e.listen(emitChange)},o),get=()=>n.current;return(0,k.useSyncExternalStore)(s,get,get)}function getAtomKey(e){return`use${capitalizeFirstLetter(e)}`}function createAuthClient(e){let{pluginPathMethods:t,pluginsActions:n,pluginsAtoms:r,$fetch:o,$store:s,atomListeners:i}=getClientConfig(e),a={};for(let[e,t]of Object.entries(r))a[getAtomKey(e)]=()=>useStore(t);return createDynamicPathProxy({...n,...a,$fetch:o,$store:s},o,t,r,i)}}}]);