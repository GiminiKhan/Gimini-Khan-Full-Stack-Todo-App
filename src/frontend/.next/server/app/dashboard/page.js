(()=>{var e={};e.id=702,e.ids=[702],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},2686:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=s(7096),a=s(6132),i=s(7284),o=s.n(i),l=s(2564),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);s.d(t,n);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1618)),"F:\\to-do-app\\src\\frontend\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,7006)),"F:\\to-do-app\\src\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["F:\\to-do-app\\src\\frontend\\app\\dashboard\\page.tsx"],p="/dashboard/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2774:(e,t,s)=>{Promise.resolve().then(s.bind(s,8794))},8794:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>DashboardPage});var r=s(784),a=s(7415),i=s(9885),o=s(7114),l=s(8551);let n=l.Z.create({baseURL:"http://127.0.0.1:8000/api/v1",timeout:1e4,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>e,e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>(e.response?.status===401&&localStorage.removeItem("better-auth.session_token"),Promise.reject(e)));let apiGet=async(e,t)=>await n.get(e,t),apiPost=async(e,t,s)=>await n.post(e,t,s),api_apiPut=async(e,t,s)=>await n.put(e,t,s),apiDelete=async(e,t)=>await n.delete(e,t);var c=s(6157);let getTasks=async()=>{try{let e=(0,c.hP)();console.log("Access token for tasks API:",e);let t=localStorage.getItem("user"),s="";if(t)try{let e=JSON.parse(t);s=e.id}catch(e){console.error("Error parsing user from localStorage:",e)}if(!s&&e)try{let t=e.split(".");if(3===t.length){let e=JSON.parse(atob(t[1]));s=e.userId||e.sub||e.user_id}}catch(e){console.error("Error decoding token to get user ID:",e)}if(console.log("User ID for tasks API:",s),!s)throw Error("User ID is required to fetch tasks");let r=await apiGet(`/api/${s}/tasks`);return r.data}catch(e){throw console.error("Error fetching tasks:",e),e}},createTask=async e=>{try{let t=(0,c.hP)(),s="";if(t)try{let e=t.split(".");if(3===e.length){let t=JSON.parse(atob(e[1]));s=t.userId||t.sub||t.user_id}}catch(e){console.error("Error decoding token to get user ID:",e)}if(!s)throw Error("User ID is required to create task");let r=await apiPost(`/api/${s}/tasks`,e);return r.data}catch(e){throw console.error("Error creating task:",e),e}},deleteTask=async e=>{try{let t=(0,c.hP)(),s="";if(t)try{let e=t.split(".");if(3===e.length){let t=JSON.parse(atob(e[1]));s=t.userId||t.sub||t.user_id}}catch(e){console.error("Error decoding token to get user ID:",e)}if(!s)throw Error("User ID is required to delete task");await apiDelete(`/api/${s}/tasks/${e}`)}catch(e){throw console.error("Error deleting task:",e),e}},toggleTaskCompletion=async(e,t)=>{try{let s=(0,c.hP)(),r="";if(s)try{let e=s.split(".");if(3===e.length){let t=JSON.parse(atob(e[1]));r=t.userId||t.sub||t.user_id}}catch(e){console.error("Error decoding token to get user ID:",e)}if(!r)throw Error("User ID is required to toggle task completion");let a=await api_apiPut(`/api/${r}/tasks/${e}/complete?is_completed=${t}`);return a.data}catch(e){throw console.error("Error toggling task completion:",e),e}};var d=s(5555),p=s(599),u=s(3770),h=s(8699);let x=i.forwardRef(({className:e,...t},s)=>r.jsx("textarea",{className:(0,h.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...t}));x.displayName="Textarea";var m=s(6006),g=s(1264);let f=i.forwardRef(({className:e,...t},s)=>r.jsx(m.fC,{ref:s,className:(0,h.cn)("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:r.jsx(m.z$,{className:(0,h.cn)("grid place-content-center text-current"),children:r.jsx(g.Z,{className:"h-4 w-4"})})}));f.displayName=m.fC.displayName;var y=s(2451),k=s(465),b=s(2385),v=s(6303);function DashboardPage(){let{user:e,loading:t,logout:s}=(0,a.useAuth)(),l=(0,o.useRouter)(),{toast:n}=(0,k.pm)(),[c,h]=(0,i.useState)(!1),[m,g]=(0,i.useState)([]),[j,N]=(0,i.useState)(!0),[_,w]=(0,i.useState)(!1),[P,q]=(0,i.useState)({title:"",description:""});(0,i.useEffect)(()=>{h(!0),console.log("Current User:",e),console.log("Auth Loading:",t)},[e,t,l]),(0,i.useEffect)(()=>{e&&c?fetchTasks():t||e||console.log("No user authenticated, staying on dashboard for testing")},[e,c,t]);let fetchTasks=async()=>{try{N(!0);let e=await getTasks();g(e)}catch(e){console.error("Error fetching tasks:",e),n({title:"Error",description:"Failed to load tasks. Please try again.",variant:"destructive"})}finally{N(!1)}},handleCreateTask=async e=>{if(e.preventDefault(),P.title.trim()){w(!0);try{let e={...P,is_completed:!1},t=await createTask(e);g([t,...m]),q({title:"",description:""}),n({title:"Task Created",description:"Your task has been created successfully!"})}catch(e){console.error("Error creating task:",e),n({title:"Error",description:"Failed to create task. Please try again.",variant:"destructive"})}finally{w(!1)}}},handleToggleTask=async(e,t)=>{try{let s=await toggleTaskCompletion(e,!t);g(m.map(t=>t.id===e?s:t))}catch(e){console.error("Error toggling task:",e),n({title:"Error",description:"Failed to update task. Please try again.",variant:"destructive"})}},handleDeleteTask=async e=>{try{await deleteTask(e),g(m.filter(t=>t.id!==e)),n({title:"Task Deleted",description:"Your task has been deleted successfully!"})}catch(e){console.error("Error deleting task:",e),n({title:"Error",description:"Failed to delete task. Please try again.",variant:"destructive"})}};return t||!c?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"text-lg",children:"Loading..."})}):r.jsx("div",{className:"container mx-auto py-10",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[r.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Todo Dashboard"}),(0,r.jsxs)(p.Zb,{className:"mb-8",children:[r.jsx(p.Ol,{children:r.jsx(p.ll,{children:"Add New Task"})}),r.jsx(p.aY,{children:(0,r.jsxs)("form",{onSubmit:handleCreateTask,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(y._,{htmlFor:"title",children:"Title"}),r.jsx(u.I,{id:"title",value:P.title,onChange:e=>q({...P,title:e.target.value}),placeholder:"What needs to be done?",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(y._,{htmlFor:"description",children:"Description"}),r.jsx(x,{id:"description",value:P.description,onChange:e=>q({...P,description:e.target.value}),placeholder:"Add details (optional)"})]}),r.jsx(d.z,{type:"submit",disabled:_,className:"w-full",children:_?(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx("span",{className:"mr-2",children:"Creating..."}),r.jsx("span",{className:"animate-spin",children:"â³"})]}):(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx(b.Z,{className:"mr-2 h-4 w-4"}),"Add Task"]})})]})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-2xl font-semibold",children:"Your Tasks"}),j?r.jsx("div",{className:"text-center py-8",children:"Loading tasks..."}):0===m.length?r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-lg text-gray-500",children:"No tasks yet. Add your first task above!"})}):r.jsx("div",{className:"space-y-3",children:m.map(e=>(0,r.jsxs)(p.Zb,{className:"flex items-center justify-between p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(f,{id:`task-${e.id}`,checked:e.is_completed,onCheckedChange:()=>handleToggleTask(e.id,e.is_completed)}),(0,r.jsxs)("div",{children:[r.jsx(y._,{htmlFor:`task-${e.id}`,className:`text-base ${e.is_completed?"line-through text-gray-500":""}`,children:e.title}),e.description&&r.jsx("p",{className:`text-sm ${e.is_completed?"text-gray-500":"text-gray-600"}`,children:e.description})]})]}),r.jsx(d.z,{variant:"ghost",size:"sm",onClick:()=>handleDeleteTask(e.id),className:"text-red-500 hover:text-red-700",children:r.jsx(v.Z,{className:"h-4 w-4"})})]},e.id))})]}),r.jsx("div",{className:"mt-8 flex justify-end",children:r.jsx(d.z,{variant:"outline",onClick:()=>{s(),l.push("/login")},children:"Logout"})})]})})}},1618:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>o,__esModule:()=>i,default:()=>n});var r=s(5153);let a=(0,r.createProxy)(String.raw`F:\to-do-app\src\frontend\app\dashboard\page.tsx`),{__esModule:i,$$typeof:o}=a,l=a.default,n=l}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[225,121,691,280,914],()=>__webpack_exec__(2686));module.exports=s})();